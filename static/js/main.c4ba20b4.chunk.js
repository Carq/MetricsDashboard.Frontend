(this["webpackJsonptilesdashboard.frontend"]=this["webpackJsonptilesdashboard.frontend"]||[]).push([[0],{212:function(e,t,a){e.exports=a(446)},419:function(e,t,a){},438:function(e,t,a){},439:function(e,t,a){},440:function(e,t,a){},441:function(e,t,a){},444:function(e,t,a){},445:function(e,t,a){},446:function(e,t,a){"use strict";a.r(t);a(213);var r=a(0),n=a.n(r),i=a(18),c=a.n(i),o=(a(419),a(192)),l=a(114),u=a(109),s=a(467),m=a(149),d=a.n(m),p={URL:"https://localhost:5001"},f={name:"Tiles",refreshInterval:180};var h=a(201),E=a(48),T=a(49),v=a(50),g=a(51),y=a(73),b=a.n(y),O=a(478),_=a(115),L=a(480),w=a(479),j=a(195),S=a.n(j),I=a(474),A=a(475),k=a(476),R=a(477),C=a(199),M=a.n(C),N=a(41),P=a.n(N),D={WEATHER:"weather",METRIC:"metric"},x={PERCENTAGE:"percentage",MONEY:"money",TIME:"time"},G="green",U="lightgreen",q="amber",F="red",H="blue",W="lightBlue",B="aqua",Y=a(4);Y.PropTypes.shape({name:Y.PropTypes.string.isRequired,type:Y.PropTypes.oneOf(Object.values(D))}),Y.PropTypes.shape({limit:Y.PropTypes.number.isRequired,wish:Y.PropTypes.number,goal:Y.PropTypes.number,metricType:Y.PropTypes.oneOf(Object.values(x)).isRequired}),Y.PropTypes.shape({temperature:Y.PropTypes.number.isRequired,humidity:Y.PropTypes.number,addedOn:Y.PropTypes.string.isRequired}),Y.PropTypes.shape({value:Y.PropTypes.number.isRequired,date:Y.PropTypes.string.isRequired});function z(e){if(e)return{green:e===G,"light-green":e===U,amber:e===q,red:e===F,blue:e===H,"light-blue":e===W,aqua:e===B}}function Q(e){if(e)return{"background-green":e===G,"background-light-green":e===U,"background-amber":e===q,"background-red":e===F,"background-blue":e===H,"background-light-blue":e===W,"background-aqua":e===B}}var V=a(482),J=a(469),X=(a(438),function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(E.a)(this,a);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n))).calculateRank=function(e,t,a,r){if(t===a)return 3;var n=Math.max(((a-t)/4).toFixed(1),r);return e>=a?5:e>=a-n?4:e>=a-2*n?3:e>=a-3*n?2:1},e}return Object(T.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.data,r=t.colorData,i=t.valueSuffix,c=t.minimalStep,o=b.a.sortBy(a,"date"),l=Math.max(b.a.maxBy(a,"value").value),u=Math.min(b.a.minBy(a,"value").value);return n.a.createElement("div",{className:"histogram"},n.a.createElement("div",{className:"histogram__bars"},o.map((function(t){var a="".concat(t.value).concat(i||""," ").concat(function(e){var t=new Date(e),a="".concat(t.getMinutes()).padStart(2,"0");return"".concat(t.getHours(),":").concat(a)}(t.date));return n.a.createElement(V.a,{key:b.a.uniqueId(),TransitionComponent:J.a,title:a,arrow:!0},n.a.createElement("div",{className:P()("histogram__bar-".concat(e.calculateRank(t.value,u,l,c)),r&&Q(r(t.value)))}))}))))}}]),a}(n.a.Component));X.defaultProps={minimalStep:.1};var $=X,K=(a(439),function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(E.a)(this,a);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n))).calculateTemperatureColor=function(e){return e>25?F:e>23?q:e>19?U:e>4?W:H},e}return Object(T.a)(a,[{key:"render",value:function(){var e=this.props,t=e.temperature,a=e.humidity,r=e.data,i=this.calculateTemperatureColor(t);return n.a.createElement("div",{className:"weather-tile__content"},n.a.createElement(L.a,{justifyContent:"center"},n.a.createElement("div",{className:"weather-tile__section"},n.a.createElement("div",{className:"weather-tile__temperature-histogram"},n.a.createElement($,{data:r.map((function(e){return{value:e.temperature,date:e.addedOn}})),valueSuffix:"\xb0C",colorData:this.calculateTemperatureColor})),n.a.createElement(_.a,{className:P()(z(i)),variant:"h3",align:"center"},"".concat(t.toFixed(1),"\xb0C"))),n.a.createElement(_.a,{align:"center",color:"textSecondary"},"Temperature")),n.a.createElement(L.a,{mt:2},n.a.createElement("div",{className:"weather-tile__section"},n.a.createElement("div",{className:"weather-tile__humidity-histogram"},n.a.createElement($,{data:r.map((function(e){return{value:e.humidity,date:e.addedOn}})),valueSuffix:"%",minimalStep:1,colorData:function(){return B}})),n.a.createElement(_.a,{variant:"h5",align:"center"},"".concat(a.toFixed(0),"%"))),n.a.createElement(_.a,{align:"center",color:"textSecondary"},"Humidity")))}}]),a}(n.a.Component)),Z=a(470),ee=a(471),te=a(472),ae=a(473),re=(a(440),function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(E.a)(this,a);for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).renderTableRow=function(t,a,r,i){return n.a.createElement(Z.a,{key:t},n.a.createElement(ee.a,{align:"right"},n.a.createElement(_.a,null,t)),n.a.createElement(ee.a,{align:"center"},n.a.createElement(_.a,{className:P()(z(i))},e.renderValues(a,r))))},e.renderValues=function(t,a){if(void 0===t||null===t)return"-";switch(a){case"percentage":return"".concat(t,"%");case"money":return"".concat(t,"\u20ac");case"time":return e.getFormatedTime(t);default:return t}},e.calculateStatusGreater=function(e,t){return.96*e>t?G:e>t?q:F},e.calculateStatusSmaller=function(e,t){return 1.05*e<t?G:e<t?q:F},e.getFormatedTime=function(e){var t=function(e){return"".concat(Math.floor(e)).slice(-2)},a=t(e/3600),r=t(e%3600/60),n=t(e%60),i=a>0?"".concat(a,"h "):"";return i+=r>0?"".concat(r,"m "):"",i+=n>0?"".concat(n,"s "):""},e}return Object(T.a)(a,[{key:"render",value:function(){var e=this.props,t=e.current,a=e.configuration,r=a.metricType,i=a.limit,c=a.wish,o=a.goal,l=r===x.PERCENTAGE?this.calculateStatusGreater(t,i):this.calculateStatusSmaller(t,i);return n.a.createElement("div",{className:"metric-tile-content"},n.a.createElement(te.a,{size:"small",style:{width:200}},n.a.createElement(ae.a,null,this.renderTableRow("Current",t,r,l),this.renderTableRow("Limit",i,r),this.renderTableRow("Goal",o,r),this.renderTableRow("Wish",c,r))))}}]),a}(n.a.Component)),ne=(a(441),function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(E.a)(this,a);for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).renderTileContent=function(t){var a=e.props,r=a.data,n=a.configuration;switch(t){case D.WEATHER:return e.renderWeatherTileContent(r[0],r.slice(1));case D.METRIC:return e.renderMetricTileContent(r[0],n);default:return e.renderUnsupportedTile()}},e.renderWeatherTileContent=function(e,t){return n.a.createElement(K,{temperature:e.temperature,humidity:e.humidity,data:t})},e.renderMetricTileContent=function(e,t){return n.a.createElement(re,{current:e.value,configuration:t})},e.renderUnsupportedTile=function(){return n.a.createElement(L.a,{textAlign:"center"},n.a.createElement(M.a,{fontSize:"large",color:"error"}),n.a.createElement(_.a,{color:"error"},"Unsupported Tile"))},e}return Object(T.a)(a,[{key:"render",value:function(){var e=this.props,t=e.basicData,a=e.data[0].addedOn;return n.a.createElement(I.a,{className:P()("card",{metric:t.type===D.METRIC,weather:t.type===D.WEATHER})},n.a.createElement(A.a,{className:"card-header",title:t.name}),n.a.createElement(k.a,null,this.renderTileContent(t.type)),n.a.createElement(R.a,{m:0,disableSpacing:!0},n.a.createElement(L.a,{color:"text.hint",fontSize:12,textAlign:"left",top:100},"Last updated:"," ",a&&S()(a).format("DD.MM.YYYY HH:mm"))))}}]),a}(n.a.Component)),ie=(a(444),function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(E.a)(this,a);for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).state={lastTilesAmount:4,lastUpdatedTile:null},e.displaySkeletons=function(){var t=e.state.lastTilesAmount;return Object(h.a)(Array(parseInt(t)).keys()).map((function(e){return n.a.createElement(O.a,{item:!0,key:e},n.a.createElement(w.a,{variant:"rect",height:300,width:305}))}))},e.componentDidMount=function(){var t=e.props.getAllTiles,a=localStorage.getItem("lastTilesAmount");a&&e.setState({lastTilesAmount:a}),e.refreshTileInterval=setInterval((function(){return e.refreshTile()}),1e3*(f.refreshInterval||60)),t()},e.refreshTile=function(){var t,a=e.props,r=a.getTile,n=a.tiles,i=e.state.lastUpdatedTile;if(i){var c=b.a.findIndex(n,{name:i.name,type:i.type});++c>n.length&&(c=0),t=n[c]}r((t=t||n[0]).name,t.type),e.setState({lastUpdatedTile:{name:t.name,type:t.type}})},e}return Object(T.a)(a,[{key:"componentWillUnmount",value:function(){clearInterval(this.refreshTileInterval)}},{key:"componentDidUpdate",value:function(e){var t=this.props,a=t.error,r=t.enqueueSnackbar,n=t.tiles,i=t.isLoadingMetrics;e.error!==a&&a&&r(a,{variant:"error"}),e.tiles.length===n.length||i||localStorage.setItem("lastTilesAmount",n.length)}},{key:"render",value:function(){var e=this.props,t=e.tiles,a=e.isLoadingMetrics;return n.a.createElement("div",{className:"main"},n.a.createElement(_.a,{variant:"h2",color:"primary"},n.a.createElement(L.a,{lineHeight:2,textAlign:"center"},f.name||"Tiles")),n.a.createElement(O.a,{container:!0,direction:"row",justify:"center",alignItems:"flex-start",className:"dashboard-grid",spacing:4},a&&this.displaySkeletons(),!a&&t&&t.map((function(e){return n.a.createElement(O.a,{item:!0,key:e.name},n.a.createElement(ne,{basicData:{name:e.name,type:e.type},data:e.data,configuration:e.configuration,lastUpdated:e.data[0].addedOn}))}))))}}]),a}(n.a.Component)),ce=Object(l.b)((function(e){return{tiles:e.tiles.items,isLoadingMetrics:e.tiles.isLoadingMetrics,error:e.tiles.error}}),(function(e){return{getAllTiles:function(){return e((function(e){return e({type:"GET_ALL_TILES_REQUEST"}),d()("".concat(p.URL,"/tiles/all")).then((function(e){if(e.status>=400)throw new Error("Bad response from server");return e.json()})).then((function(t){return e(function(e){return{type:"GET_ALL_TILES_COMPLETED",tiles:e}}(t))})).catch((function(t){return e(function(e){return{type:"GET_ALL_TILES_FAILED",error:e}}(t.message))}))}))},getTile:function(t,a){return e(function(e,t){return function(a){return a(function(e,t){return{type:"GET_TILE_REQUEST",tileName:e,tileType:t}}(e,t)),d()("".concat(p.URL,"/tiles/").concat(t,"/").concat(e,"/recent")).then((function(e){if(e.status>=400)throw new Error("Bad response from server");return e.json()})).then((function(r){return a(function(e,t,a){return{type:"GET_TILE_COMPLETED",data:e,tileName:t,tileType:a}}(r,e,t))})).catch((function(e){return a(function(e){return{type:"GET_TILE_FAILED",error:e}}(e.message))}))}}(t,a))}}}))(Object(u.withSnackbar)(ie)),oe=a(107),le=Object(oe.a)({palette:{type:"dark",primary:{main:"#6decb9"}},overrides:{MuiTooltip:{tooltip:{fontSize:"1em"}}}}),ue=a(58),se=a(200),me=a(54),de={items:[],isLoadingMetrics:!1,error:""};function pe(e,t,a,r){return e.map((function(e){if(e.name!==t||e.type!==a)return e;var n=Object(me.a)({},e,{data:r});return Object(me.a)({},e,{},n)}))}var fe=Object(ue.c)({tiles:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:de,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_ALL_TILES_REQUEST":return Object(me.a)({},e,{isLoadingMetrics:!0});case"GET_ALL_TILES_COMPLETED":return Object(me.a)({},e,{items:t.tiles,isLoadingMetrics:!1});case"GET_ALL_TILES_FAILED":return Object(me.a)({},e,{error:t.error,isLoadingMetrics:!1});case"GET_TILE_REQUEST":return Object(me.a)({},e);case"GET_TILE_COMPLETED":var a=e.items;return Object(me.a)({},e,{items:pe(a,t.tileName,t.tileType,t.data)});case"GET_TILE_FAILED":return Object(me.a)({},e,{error:t.error});default:return e}}});a(445);var he=function(){var e=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||ue.d;return Object(ue.e)(fe,e(Object(ue.a)(se.a)))}();var Ee=function(){return n.a.createElement(s.a,{theme:le},n.a.createElement(l.a,{store:he},n.a.createElement("div",{className:"App"},n.a.createElement(o.Helmet,null,n.a.createElement("title",null,f.name||"Tiles Dashboard")),n.a.createElement(u.SnackbarProvider,null,n.a.createElement(ce,null)))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(n.a.createElement(Ee,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[212,1,2]]]);
//# sourceMappingURL=main.c4ba20b4.chunk.js.map